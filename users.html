<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MessPro Admin - User Management</title>
    <link rel="stylesheet" href="admin.css"> <link rel="stylesheet" href="users.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>


<nav class="admin-nav">
    <div class="logo">MessPro Admin</div>
    <div class="nav-links">
        <a href="index3.html">Home</a>
        <a href="admin.html">Dashboard</a>
        <a href="users.html" class="active">User Management</a>
        <a href="inventory.html">Inventory</a>
    </div>
    <button class="logout-btn" onclick="adminLogout()">Admin Logout</button>
</nav>

<main class="content-container">
    <div class="table-header">
        <h2 class="section-title">Registered Students</h2>
        <div class="actions-row">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search by Name or ID...">
                <button onclick="searchStudents()">üîç</button>
            </div>
            <button class="add-btn" onclick="showAddStudentModal()">+ Add New Student</button>
        </div>
    </div>
    <table class="admin-table">
    <thead>
        <tr><th>ID</th><th>Name</th><th>Room</th><th>Plan</th><th>Actions</th></tr>
    </thead>
    <tbody id="studentTableBody"></tbody>
</table>

<div id="addModal" style="background:white; padding:20px; border:1px solid #ccc; position:fixed; top:20%; left:30%; width:400px;">
    <h3>Add Student</h3>
    <input type="text" id="newID" placeholder="Student ID">
    <input type="text" id="newName" placeholder="Full Name">
    <input type="text" id="newRoom" placeholder="Room No">
    <input type="text" id="newPlan" placeholder="Plan (Regular/Premium)">
    <button onclick="addNewStudent()">Save Student</button>
</div>

<script>
async function loadStudents() {
    const res = await fetch('/api/admin/users');
    const students = await res.json();
    document.getElementById('studentTableBody').innerHTML = students.map(s => `
        <tr><td>${s.username}</td><td>${s.name}</td><td>${s.room_no}</td><td>${s.plan_type}</td>
        <td><button onclick="deleteUser('${s.username}')">üóëÔ∏è</button></td></tr>`).join('');
}

async function addNewStudent() {
    const studentData = {
        username: document.getElementById('newID').value,
        name: document.getElementById('newName').value,
        room_no: document.getElementById('newRoom').value,
        plan_type: document.getElementById('newPlan').value
    };
    await fetch('/api/users', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(studentData)
    });
    location.reload();
}
window.onload = loadStudents;
</script>
</body>
</html>